\hypertarget{_lightstribe_8c}{}\subsection{Lightstribe.\+c File Reference}
\label{_lightstribe_8c}\index{Lightstribe.\+c@{Lightstribe.\+c}}


basic functions for controlling W\+S2811/\+W\+S2812 L\+E\+Ds  


{\ttfamily \#include \char`\"{}globals.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Lightstribe.\+h\char`\"{}}\\*
{\ttfamily \#include $<$util/delay.\+h$>$}\\*
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_lightstribe_8c_a63fa595d401f0e85c1bba55ba2b1d66e}{changeled} (struct \hyperlink{structcolor24bit}{color24bit} color, uint8\+\_\+t $\ast$lightdata, uint8\+\_\+t lednr)
\begin{DoxyCompactList}\small\item\em change the color of one L\+E\+D at a specific position; run transmit2leds afterwards to update the L\+E\+Ds \end{DoxyCompactList}\item 
void \hyperlink{_lightstribe_8c_abba9462833e30ef725eaf18c3d01eb71}{setled} (struct \hyperlink{structcolor24bit}{color24bit} color, uint8\+\_\+t $\ast$lightdata, uint8\+\_\+t lednr)
\begin{DoxyCompactList}\small\item\em set the color of one L\+E\+D at a specific position, all others are off; run transmit2leds afterwards to update the L\+E\+Ds \end{DoxyCompactList}\item 
void \hyperlink{_lightstribe_8c_aac724dad670e4a26723daf71ce6a8d8a}{transmit2leds} (uint8\+\_\+t lightdata\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em transmit the color array to the stribe \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
basic functions for controlling W\+S2811/\+W\+S2812 L\+E\+Ds 

This file contains the basic functions to control W\+S2811/\+W\+S2812 L\+E\+Ds using an A\+V\+R. It declares the function to transmit lightdata to a stribe using the one wire protocol. For the right timing be aware of the crystal frequency! This code is written for using an extern clock of 16 M\+Hz, if you change it you need to modify the number of N\+O\+Ps in the macros defined in the header file. This file also contains the basic functions to set or to change one L\+E\+D in the stribe. The whole system is working with a color array that stores the 24 Bit colors for all L\+E\+Ds in an G\+R\+B format (W\+S2812). Every effect changes the array, after that the array is sent out by the transmit2leds function. This guarantees a correct timing. The most functions base on uint8\+\_\+t variables so the maximum length of the stribe to control contains 255 L\+E\+Ds. This should not be changed because you have hardware limitations as well that will limit a basic setup to 200-\/250 L\+E\+Ds. \begin{DoxyVersion}{Version}
V1.\+00 
\end{DoxyVersion}
\begin{DoxyDate}{Date}
05.\+01.\+2016 
\end{DoxyDate}
\begin{DoxyAuthor}{Authors}
Wank Florian 
\end{DoxyAuthor}


Definition in file \hyperlink{_lightstribe_8c_source}{Lightstribe.\+c}.



\subsubsection{Function Documentation}
\hypertarget{_lightstribe_8c_a63fa595d401f0e85c1bba55ba2b1d66e}{}\index{Lightstribe.\+c@{Lightstribe.\+c}!changeled@{changeled}}
\index{changeled@{changeled}!Lightstribe.\+c@{Lightstribe.\+c}}
\paragraph[{changeled(struct color24bit color, uint8\+\_\+t $\ast$lightdata, uint8\+\_\+t lednr)}]{\setlength{\rightskip}{0pt plus 5cm}void changeled (
\begin{DoxyParamCaption}
\item[{struct {\bf color24bit}}]{color, }
\item[{uint8\+\_\+t $\ast$}]{lightdata, }
\item[{uint8\+\_\+t}]{lednr}
\end{DoxyParamCaption}
)}\label{_lightstribe_8c_a63fa595d401f0e85c1bba55ba2b1d66e}


change the color of one L\+E\+D at a specific position; run transmit2leds afterwards to update the L\+E\+Ds 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structcolor24bit}{color24bit} color \+: 24 bit color in G\+R\+B format \\
\hline
\mbox{\tt in}  & {\em uint8\+\_\+t} & $\ast$lightdata \+: pointer to the complete lightdata that contains all color values \\
\hline
\mbox{\tt in}  & {\em uint8\+\_\+t} & lednr \+: position of the L\+E\+D that should be changed \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
the right color format is created using the colorconv8to24-\/function with the ledtype predefined 
\end{DoxyNote}


Definition at line \hyperlink{_lightstribe_8c_source_l00033}{33} of file \hyperlink{_lightstribe_8c_source}{Lightstribe.\+c}.



References \hyperlink{_lightstribe_8h_source_l00022}{color24bit\+::blue}, \hyperlink{_lightstribe_8h_source_l00020}{color24bit\+::green}, \hyperlink{globals_8h_source_l00025}{Num\+Of\+Leds}, and \hyperlink{_lightstribe_8h_source_l00018}{color24bit\+::red}.



Referenced by \hyperlink{_led_effects_8c_source_l00489}{eastereggbase()}, \hyperlink{_led_effects_8c_source_l00549}{fillup()}, \hyperlink{_led_effects_8c_source_l00300}{init\+\_\+alternating()}, \hyperlink{_led_effects_8c_source_l00442}{initrainbow()}, \hyperlink{_led_effects_8c_source_l00217}{initrunled()}, \hyperlink{ws2811lichterkette_8c_source_l00447}{main()}, and \hyperlink{_led_effects_8c_source_l00340}{recolor()}.

\hypertarget{_lightstribe_8c_abba9462833e30ef725eaf18c3d01eb71}{}\index{Lightstribe.\+c@{Lightstribe.\+c}!setled@{setled}}
\index{setled@{setled}!Lightstribe.\+c@{Lightstribe.\+c}}
\paragraph[{setled(struct color24bit color, uint8\+\_\+t $\ast$lightdata, uint8\+\_\+t lednr)}]{\setlength{\rightskip}{0pt plus 5cm}void setled (
\begin{DoxyParamCaption}
\item[{struct {\bf color24bit}}]{color, }
\item[{uint8\+\_\+t $\ast$}]{lightdata, }
\item[{uint8\+\_\+t}]{lednr}
\end{DoxyParamCaption}
)}\label{_lightstribe_8c_abba9462833e30ef725eaf18c3d01eb71}


set the color of one L\+E\+D at a specific position, all others are off; run transmit2leds afterwards to update the L\+E\+Ds 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em struct} & \hyperlink{structcolor24bit}{color24bit} color \+: 24 bit color in G\+R\+B format \\
\hline
\mbox{\tt in}  & {\em uint8\+\_\+t} & $\ast$lightdata \+: pointer to the complete lightdata that contains all color values \\
\hline
\mbox{\tt in}  & {\em uint8\+\_\+t} & lednr \+: position of the L\+E\+D that should be set \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
the right color format is created using the colorconv8to24-\/function with the ledtype predefined; all other L\+E\+Ds are cleared so they are off 
\end{DoxyNote}


Definition at line \hyperlink{_lightstribe_8c_source_l00051}{51} of file \hyperlink{_lightstribe_8c_source}{Lightstribe.\+c}.



References \hyperlink{_lightstribe_8h_source_l00022}{color24bit\+::blue}, \hyperlink{_lightstribe_8h_source_l00020}{color24bit\+::green}, \hyperlink{globals_8h_source_l00025}{Num\+Of\+Leds}, and \hyperlink{_lightstribe_8h_source_l00018}{color24bit\+::red}.

\hypertarget{_lightstribe_8c_aac724dad670e4a26723daf71ce6a8d8a}{}\index{Lightstribe.\+c@{Lightstribe.\+c}!transmit2leds@{transmit2leds}}
\index{transmit2leds@{transmit2leds}!Lightstribe.\+c@{Lightstribe.\+c}}
\paragraph[{transmit2leds(uint8\+\_\+t lightdata[])}]{\setlength{\rightskip}{0pt plus 5cm}void transmit2leds (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{lightdata\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\label{_lightstribe_8c_aac724dad670e4a26723daf71ce6a8d8a}


transmit the color array to the stribe 

To control the L\+E\+Ds of type W\+S2811/\+W\+S2812 a critical timing is necessary. To achieve the correct timing and to create effects the lightdata is stored in an array first. All operations effect the color array. If the color array is prepared it is transmitted to the stribes via a one-\/wire protocol using this function. This function generates the high and low times using assembler N\+O\+Ps to achieve the timing. The number of N\+O\+Ps are stored in macros for transmitting a Low Bit (S\+E\+T\+L\+O\+W) or a High Bit (S\+E\+T\+H\+I\+G\+H). This function should not be changed or optimized because of the timing! 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em uint8\+\_\+t} & lightdata\mbox{[}\mbox{]} \+: data with the colors for each L\+E\+D to control \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxyNote}{Note}
This function should not be changed or optimized because of the timing! Do not use higher optimization than O1!!! Do not remove the \{\} brackets because S\+E\+T\+L\+O\+W/\+S\+E\+T\+H\+I\+G\+H are definitions with several commands! 
\end{DoxyNote}


Definition at line \hyperlink{_lightstribe_8c_source_l00096}{96} of file \hyperlink{_lightstribe_8c_source}{Lightstribe.\+c}.



References \hyperlink{globals_8h_source_l00025}{Num\+Of\+Leds}.



Referenced by \hyperlink{_led_effects_8c_source_l00278}{blinkled()}, \hyperlink{_led_effects_8c_source_l00489}{eastereggbase()}, \hyperlink{_led_effects_8c_source_l00366}{faden()}, \hyperlink{_led_effects_8c_source_l00549}{fillup()}, \hyperlink{ws2811lichterkette_8c_source_l00447}{main()}, \hyperlink{_led_effects_8c_source_l00340}{recolor()}, \hyperlink{_led_effects_8c_source_l00323}{run\+\_\+alternating()}, and \hyperlink{_led_effects_8c_source_l00236}{runrunled()}.

